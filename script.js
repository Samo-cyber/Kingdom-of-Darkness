const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;if (prefersReducedMotion) {document.documentElement.classList.add('reduced-motion');}/* Global brand colors from CSS variables */const styles = getComputedStyle(document.documentElement);const BRAND_RED = styles.getPropertyValue('--brand-red').trim();const BRAND_ACCENT = styles.getPropertyValue('--brand-accent').trim();const TEXT_LIGHT = styles.getPropertyValue('--text-light').trim();const BRAND_BG = styles.getPropertyValue('--brand-bg').trim();/* --- Howler.js Sound System --- */let globalAmbientSound;let whisperSound;let flickerSound;let soundEnabled = false;const soundConsentModal = document.querySelector('.sound-consent-modal');const enableSoundBtn = document.getElementById('enableSoundBtn');const disableSoundBtn = document.getElementById('disableSoundBtn');function initSounds() {if (prefersReducedMotion) return;Howler.autoUnlock = false;globalAmbientSound = new Howl({src: ['https://assets.mixkit.co/sfx/preview/mixkit-wind-sweeping-160.ogg'], // Placeholderloop: true,volume: 0.04, // -24dB is roughly 0.063, but 0.04 is softerhtml5: true,});whisperSound = new Howl({src: ['https://assets.mixkit.co/sfx/preview/mixkit-ominous-whip-sound-2008.ogg'], // Placeholder - short whispervolume: 0.1, //-18dB is roughly 0.125html5: true,});flickerSound = new Howl({src: ['https://assets.mixkit.co/sfx/preview/mixkit-light-flicker-166.ogg'], // Placeholder - flicker clickvolume: 0.1, // -20dB is roughly 0.1html5: true,});}enableSoundBtn.addEventListener('click', () => {soundEnabled = true;soundConsentModal.classList.add('hidden');if (!prefersReducedMotion) {initSounds();globalAmbientSound.play();}});disableSoundBtn.addEventListener('click', () => {soundConsentModal.classList.add('hidden');console.log('Sound disabled by user.');});// Show modal on page load to ask for consentwindow.addEventListener('load', () => {if (prefersReducedMotion) {soundConsentModal.classList.add('hidden');} else {soundConsentModal.classList.remove('hidden');}});/* --- GSAP Animations --- */gsap.registerPlugin();const heroTitle = document.querySelector('.hero-section .title');const heroSubtitle = document.querySelector('.hero-section .subtitle');const heroCta = document.querySelector('.cta-button');const heroLogo = document.querySelector('.hero-section .logo');const heroFog = document.querySelector('.hero-background-fog');const heroGlow = document.querySelector('.hero-background-glow');const heroSpotlight = document.querySelector('.hero-background-spotlight');const storyCards = gsap.utils.toArray('.story-card');const tl = gsap.timeline({defaults: {ease: 'power3.out'}});tl.from(heroLogo, {opacity: 0, y: -50, duration: 1}, 0.5).from(heroTitle, {opacity: 0, y: -24, duration: 1.2, stagger: 0.06}, "-=0.8").from(heroSubtitle, {opacity: 0, y: -20, duration: 1}, "-=0.6").from(heroCta, {opacity: 0, scale: 0.8, duration: 0.8}, "-=0.4").from([heroFog, heroGlow, heroSpotlight], {opacity: 0, duration: 1.6}, 0);/* Mouse Parallax for Hero */if (!prefersReducedMotion) {document.addEventListener('mousemove', (e) => {const x = e.clientX / window.innerWidth - 0.5;const y = e.clientY / window.innerHeight - 0.5;gsap.to(heroTitle, {x: x * 40, y: y * 30, duration: 1.5, ease: 'power2.out'});gsap.to(heroSubtitle, {x: x * 30, y: y * 25, duration: 1.5, ease: 'power2.out'});gsap.to(heroLogo, {x: x * 20, y: y * 15, duration: 1.5, ease: 'power2.out'});gsap.to(heroCta, {x: x * 15, y: y * 10, duration: 1.5, ease: 'power2.out'});gsap.to(heroFog, {x: x * 10, y: y * 8, duration: 1.8, ease: 'power2.out'}); // fog: 0.04 * 200 = 8pxgsap.to(heroGlow, {x: x * 4, y: y * 3, duration: 1.8, ease: 'power2.out'});gsap.to(heroSpotlight, {x: x * 2, y: y * 1, duration: 1.8, ease: 'power2.out'}); // bg: 0.01 * 200 = 2px});}/* Story Card Hover Effects */storyCards.forEach(card => {const image = card.querySelector('img');const bloodCrack = card.querySelector('.blood-crack-line');card.addEventListener('mouseenter', () => {if (soundEnabled && whisperSound && !prefersReducedMotion) {whisperSound.play();}gsap.to(image, {filter: 'brightness(0.76)', duration: 0.4});gsap.fromTo(bloodCrack, {opacity: 0, scale: 0.8, y: -10}, {opacity: 1, scale: 1, y: 0, duration: 0.45, ease: 'power2.out'});});card.addEventListener('mouseleave', () => {gsap.to(image, {filter: 'brightness(1)', duration: 0.3});gsap.to(bloodCrack, {opacity: 0, duration: 0.3});});});/* Light Flicker Logic */function startLightFlicker() {if (prefersReducedMotion) return;setInterval(() => {const shouldFlicker = Math.random() < 0.2; // ~1 in 5 chance to flicker every average intervalif (shouldFlicker) {const duration = Math.random() * 0.6; // Max 0.6sglobalAmbientSound.fade(globalAmbientSound.volume(), globalAmbientSound.volume() * 0.5, duration * 500); // Muffle ambient gsap.to(document.body, {filter: 'brightness(0.8)', duration: duration * 0.5, yoyo: true, repeat: 1, ease: 'steps(1)', onComplete: () => {gsap.to(document.body, {filter: 'brightness(1)', duration: 0.1});}});if (soundEnabled && flickerSound) {flickerSound.play();}}}, 8000); // Average interval 8 seconds}if (!prefersReducedMotion) {startLightFlicker();}